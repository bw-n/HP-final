// DONNÉES DES MEMBRES
window.members = [
  {
    nom: "JoweL Homeskillz",
    role: ["Dev", "creative 360", "founder"],
    image: "https://www.jow-l.com/uploads/9/7/1/8/9718598/published/homeskillz-450px-2017-discogs.jpg?1716919812",
    fiche: "https://www.jow-l.com/",
    metier: ["Dev", "creative 360"]
  },
  {
    nom: "Ethabo Jackson",
    role: ["Security Bodyguard"],
    image: "https://raw.githubusercontent.com/bw-n/HP-final/main/ethabo-jackson.jpg",
    fiche: "https://www.instagram.com/ethabojackson/?igsh=MW9xM3IzcmE3MHN0Yw%3D%3D#",
    metier: ["Security Bodyguard"],
    elite: true
  },
  {
    nom: "your Name",
    role: "Smart Contract Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Solidity Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Rust Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Blockchain Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Blockchain Architect",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Consensus Algorithm Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "ZKP Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Web3 Frontend Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Développement Frontend"
  },
  {
    nom: "your Name",
    role: "Web3 Backend Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Développement Backend"
  },
  {
    nom: "your Name",
    role: "Web3 Fullstack Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Développement Fullstack"
  },
  {
    nom: "your Name",
    role: "Mobile Web3 Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Développement Mobile"
  },
  {
    nom: "your Name",
    role: "dApp Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Applications Décentralisées"
  },
  {
    nom: "your Name",
    role: "DevOps Web3 Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Infrastructure & Cloud"
  },
  {
    nom: "your Name",
    role: "Cloud Architect",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Infrastructure & Cloud"
  },
  {
    nom: "your Name",
    role: "Site Reliability Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Infrastructure & Cloud"
  },
  {
    nom: "your Name",
    role: "Network Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Infrastructure & Cloud"
  },
  {
    nom: "your Name",
    role: "Cybersecurity Specialist",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Cybersécurité"
  },
  {
    nom: "your Name",
    role: "Smart Contract Auditor",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Cybersécurité"
  },
  {
    nom: "your Name",
    role: "Penetration Tester (Web3)",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Cybersécurité"
  },
  {
    nom: "your Name",
    role: "Ethical Hacker",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Cybersécurité"
  },
  {
    nom: "your Name",
    role: "Blockchain Forensics Analyst",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Cybersécurité"
  },
  {
    nom: "your Name",
    role: "Data Analyst (on-chain)",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Data & Intelligence Artificielle"
  },
  {
    nom: "your Name",
    role: "Blockchain Data Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Data & Intelligence Artificielle"
  },
  {
    nom: "your Name",
    role: "AI & ML Engineer (Web3)",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Data & Intelligence Artificielle"
  },
  {
    nom: "your Name",
    role: "Protocol Researcher",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Recherche & R&D"
  },
  {
    nom: "your Name",
    role: "Cryptography Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Recherche & R&D"
  },
  {
    nom: "your Name",
    role: "Quantum R&D Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Recherche & R&D"
  },
  {
    nom: "your Name",
    role: "Oracle Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Bridge Developer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Blockchain & Smart Contract"
  },
  {
    nom: "your Name",
    role: "Integration Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Développement Backend"
  },
  {
    nom: "your Name",
    role: "Middleware Engineer",
    image: "https://github.com/bw-n/HP/blob/main/images/logo_BW_WEB_200x200.jpg?raw=true",
    fiche: "https://www.blockchain-workers.com/exemple-profil-premium.html",
    metier: "Infrastructure & Cloud"
  }
];

// LOGIQUE DU HUB
document.addEventListener("DOMContentLoaded", function () {
  const membersData = window.members;

  // Extraire tous les métiers
  let allMetiers = membersData.flatMap(m =>
    Array.isArray(m.metier) ? m.metier : [m.metier]
  );

  // Ajouter "ELITE" si au moins un membre est elite
  const hasElite = membersData.some(m => m.elite);
  if (hasElite) allMetiers.push("ELITE");

  const uniqueFilters = [...new Set(allMetiers)].sort();

  // Éléments du DOM
  const filtersDiv = document.getElementById("filters");
  const memberGrid = document.getElementById("member-grid");
  const backButton = document.getElementById("backButton");

  if (!filtersDiv || !memberGrid || !backButton) {
    console.warn("Certains éléments HTML manquent.");
    return;
  }

  // Rendu des membres
  function renderMembers(list) {
    memberGrid.innerHTML = "";

    if (list.length === 0) {
      memberGrid.innerHTML = "<p>Aucun membre trouvé.</p>";
      return;
    }

    list.forEach(m => {
      const card = document.createElement("div");
      card.className = "member-block";
      if (m.elite) card.classList.add("elite");

      const lien = m.fiche || m.website || "#";
      const roles = Array.isArray(m.role) ? m.role.join(", ") : m.role;

      card.innerHTML = `
        <div class="member-photo" style="background-image: url('${m.image}')"></div>
        <div class="member-name">${m.nom}</div>
        <div class="member-role">${roles}</div>
        <a href="${lien}" class="view-link" target="_blank" rel="noopener noreferrer">Voir la fiche</a>
      `;

      memberGrid.appendChild(card);
    });

    // Scroll auto sur mobile
    if (window.innerWidth <= 768) {
      const y = memberGrid.getBoundingClientRect().top + window.scrollY;
      window.scrollTo({ top: y - 20, behavior: "smooth" });
    }
  }

  function showAll() {
    renderMembers(membersData);
    filtersDiv.style.display = "flex";
    backButton.style.display = "none";

    const y = filtersDiv.getBoundingClientRect().top + window.scrollY;
    const offset = window.innerWidth > 768 ? 100 : 20;
    window.scrollTo({ top: y - offset, behavior: "smooth" });
  }

  function filterBy(metier) {
    const filtered = metier === "ELITE"
      ? membersData.filter(m => m.elite)
      : membersData.filter(m =>
          Array.isArray(m.metier) ? m.metier.includes(metier) : m.metier === metier
        );

    renderMembers(filtered);
    filtersDiv.style.display = "none";
    backButton.style.display = "block";
  }

  // Créer les boutons filtres
  uniqueFilters.forEach(metier => {
    const btn = document.createElement("button");
    btn.textContent = metier;
    btn.onclick = () => filterBy(metier);
    if (metier === "ELITE") btn.classList.add("elite-btn");
    filtersDiv.appendChild(btn);
  });

  // Bouton retour
  backButton.addEventListener("click", showAll);

  // Affichage initial
  showAll();

  console.log("✅ Script chargé avec", membersData.length, "membres");
});
